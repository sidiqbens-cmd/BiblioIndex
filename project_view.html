function previewIndex(type) {
    let win = window.open('', '', 'width=900,height=700');
    let content = `<div dir="rtl" style="font-family:'Times New Roman', serif; padding:1in; column-count: 2; column-gap: 30px; font-size:11pt;">`;
    let indexMap = {}; let serial = 1;
    records.forEach(r => {
        if(!r.see && !r.see_also) {
            let val = r[type];
            if(val) { if(!indexMap[val]) indexMap[val] = []; indexMap[val].push(serial); }
            serial++;
        }
    });
    Object.keys(indexMap).sort((a,b)=>a.localeCompare(b,'ar')).forEach(key => {
        content += `<div style="margin-bottom:5pt; border-bottom:0.5pt solid #eee;">
            ${key} <span style="float:left; font-weight:bold;">(${indexMap[key].join(')( ')})</span>
            <div style="clear:both"></div>
        </div>`;
    });
    content += `</div>`; win.document.write(content);
